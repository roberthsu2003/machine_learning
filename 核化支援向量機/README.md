# 支援向量機 SVC（Support Vector Classifier）

在線性模型分類中有討論的線性模型支援向量分類,而核化支援向量機（通常簡稱為 SVM）是一種模型擴展，它允許更複雜的模型，而這些模型不是簡單地由輸入空間中的超平面定義的。雖然有用於分類和回歸的支援向量機，但我們將限制於分類情況，如在 `SVC` 中實現分類。類似的概念適用於支援向量迴歸，如在 `SVR` 中實現迴歸。

核化支援向量機背後的數學有點複雜.

## 線性模型和非線性特徵

線性模型在低維空間中受到很大限制，因為線和超平面的靈活性有限。使線性模型更靈活的一種方法是添加更多特徵 - 例如，添加輸入特徵的交互作用或多項式。

### ➜線性可分的定義：
- 如果資料可以用一條直線（在2D空間）或一個超平面（在高維空間）完全分開，那麼這些資料就是線性可分的。
- 在這種情況下，使用線性模型（如線性SVM）是合適的。

### ➜如何判斷是否線性可分：
- 在2D空間中，我們可以通過視覺化來判斷
- 如果不同類別的點可以用一條直線分開，就是線性可分
- 如果不同類別的點交錯在一起，無法用直線分開，就是非線性可分

### ➜為什麼要使用線性模型：
- 為什麼要使用線性模型：
- 線性模型計算效率高
- 解釋性好
- 不容易過擬合
- 如果資料確實是線性可分的，線性模型就能得到很好的結果

### ➜如果資料不是線性可分的：
- 我們可以使用核化技巧（Kernel Trick）
- 將資料映射到更高維的空間，使其變得線性可分
- 常用的核函數包括：RBF核、多項式核等

> [!IMPORTANT]
> 以下範例解釋低維度下不可以線性分割的範例
> [svm_1無法使用線性分割的範例](./svm_1無法使用線性分割的範例.ipynb)
> ---
> 以下範例是增加1個維度,變為3維後,使用高維分類的方式
> [svm_2增加1個特徵成為可以高維度分割範例](./svm_2增加1個特徵成為可以高維度分割範例.ipynb)

## 核技巧
核技巧的核心思想是，通過為數據添加非線性特徵，可以顯著增強線性模型的表現能力。然而，在實際應用中，我們往往不清楚應該添加哪些特徵。如果盲目添加大量特徵（例如，在100維特徵空間中考慮所有可能的特徵交互），計算成本可能會變得極高。幸運的是，有一種巧妙的數學方法，稱為核技巧，可以在不直接計算新的高維特徵表示的情況下，學習高維空間中的分類器。這種方法通過直接計算數據點在擴展特徵空間中的距離（更精確地說，是數據點的內積），而無需實際計算特徵的擴展表示。

在支持向量機中，常用的將數據映射到高維空間的方法有兩種：多項式核（Polynomial Kernel）和徑向基函數核（Radial Basis Function Kernel，簡稱RBF核），後者也稱為高斯核。多項式核會計算原始特徵的所有多項式組合，直至某個特定的次數（例如，feature1^2 * feature2^5）。而RBF核（高斯核）的解釋相對複雜，因為它對應於一個無限維的特徵空間。一種理解高斯核的方式是，它考慮了所有可能的多項式組合（包括所有次數），但高次特徵的影響會隨著次數增加而逐漸減小。

在實際應用中，核支持向量機背後的數學細節並非特別重要。使用RBF核的支持向量機如何進行決策，可以用相對簡單的方式總結。


## 理解支持向量機

在訓練過程中，支持向量機（SVM）會學習每個訓練數據點對於定義兩個類別之間決策邊界的重要性。通常，只有部分訓練數據點對於確定決策邊界具有關鍵作用，這些數據點位於類別之間的邊界上，被稱為支持向量，這也是支持向量機名稱的由來。

當對一個新數據點進行預測時，SVM會測量該數據點與每個支持向量的距離。分類決策是基於這些距離以及訓練過程中學習到的支持向量的重要性（儲存在SVC的dual_coef_屬性中）來確定的。

> [!IMPORTANT]
> 使用SVM模型建立非直線的決策邊界
> [使用SVM模型建立非直線的決策邊界範例](./svm_3使用SVC模型_建立非直線的決策邊界.ipynb)

## 調整SVM的參數

gamma參數，它控制高斯核的寬度。它決定了點靠近的尺度。 C 參數是一個正規化參數，類似於線性模型中使用的參數。

> [!IMPORTANT]
> 調整SVM的c參數和gamma參數
> [調整SVC模型的c和gamma參數_範例](./svm_4調整SVC模型的c和gamma參數.ipynb)

## 為SVM預處理資料

> [!IMPORTANT]
> 使用SVM的RBF核心,應用在乳癌資料集
> 整理數據資料,提昇SVM模型
> [乳癌資料集使用SVM_範例](svm_5乳癌資料集使用SVM.ipynb)

## 實作:
[**SVC(Support Vector Classifier）model實作**](./sklearn實作1.ipynb)