## Quantile-Quantile Plot（簡稱 Q-Q 圖）

是一種圖形工具，用於檢查數據的分佈是否符合某個特定的理論分佈，或者比較兩個數據集的分佈是否相似。

**Q-Q 圖的用途**

Q-Q 圖通過比較數據的**分量（quantiles）**與理論分佈（或另一組數據）的分量，來評估數據是否符合某個分佈。具體來說：

1. **檢查數據是否符合特定理論分佈**：例如高斯分佈（常態分佈）、均勻分佈、指數分佈等。
2. **比較兩個數據集的分佈**：判斷它們是否來自相同的分佈。

3. 如果 Q-Q 圖上的點近似落在對角線（y=x 線）上，則表示數據分佈與理論分佈（或另一組數據）一致。


**Q-Q 圖可以檢查哪些分佈？**

Q-Q 圖是通用的工具，理論上可以用來檢查任何分佈是否與數據匹配。以下是常見的分佈類型，Q-Q 圖特別適用於檢查這些分佈：

1. **高斯分佈（常態分佈, Normal Distribution）**：  
   - 最常見的應用，因為許多統計方法（如 GaussianNB）假設數據符合高斯分佈。
   - Q-Q 圖檢查數據是否呈現鐘形曲線分佈。
   - **例子**：檢查學生的考試成績是否符合高斯分佈。
   - **判斷標準**：如果點沿著對角線分佈，則數據近似高斯分佈；如果點偏離（例如呈 S 形或彎曲），則可能不符。

2. **均勻分佈（Uniform Distribution）**：  
   - 用於檢查數據是否均勻分佈在某個範圍內（每個值出現的概率相等）。  
   - **例子**：檢查隨機數生成器的輸出是否均勻分佈。  
   - **判斷標準**：如果數據符合均勻分佈，Q-Q 圖的點會近似沿對角線排列。  

3. **指數分佈（Exponential Distribution）**：  
   - 用於檢查數據是否符合指數分佈，常用於描述事件間的等待時間（如電話呼叫間隔）。
   - **例子**：檢查顧客到達商店的時間間隔是否符合指數分佈。
   - **判斷標準**：如果點沿對角線，則數據符合指數分佈；否則可能有其他分佈特性。

4. **對數正態分佈（Log-Normal Distribution）**：
   - 用於檢查數據取對數後是否符合高斯分佈，常用於描述偏態數據（如收入、股票價格）。
   - **例子**：檢查某公司員工薪資是否符合對數正態分佈。
   - **判斷標準**：對數據取對數後，Q-Q 圖與高斯分佈比較，若點沿對角線，則符合。

5. **其他分佈**：
   - Q-Q 圖也可以檢查其他分佈，例如伽馬分佈（Gamma Distribution）、韋伯分佈（Weibull Distribution）、卡方分佈（Chi-Square Distribution）等。
   - 只要能定義理論分佈的分量，Q-Q 圖就可以用來比較。

6. **比較兩個數據集**：
   - Q-Q 圖不僅限於理論分佈，還可以用來比較兩個數據集的分佈是否相同。
   - **例子**：比較兩組學生的考試成績，檢查它們是否來自同一分佈。

---

**Q-Q 圖的工作原理**

1. **分量比較**：
   - 將數據的觀測值按升序排列，計算其分量（例如，數據的第 25% 分位數）。
   - 將這些分量與理論分佈（或另一組數據）的相同分量進行比較。
2. **繪圖**：
   - X 軸：理論分佈的分量（或第二組數據的分量）。
   - Y 軸：實際數據的分量。
   - 如果點沿對角線（y=x）排列，則數據分佈與理論分佈一致。
3. **偏離的意義**：
   - 如果點呈 S 形，數據可能有偏態（skewness）。
   - 如果點呈弧形，數據可能有較重的尾部（heavy tails）或較輕的尾部（light tails）。

---
### 簡單範例
以下是三個場景，展示 Q-Q 圖如何檢查不同分佈：

1. **檢查高斯分佈**：
   - **場景**：您收集了 100 名學生的數學考試成績，想確認是否符合高斯分佈。
   - **數據**：成績範圍 0-100，平均值 75，標準差 10。
   - **Q-Q 圖**：
     - X 軸：標準正態分佈（μ=0, σ=1）的分量。
     - Y 軸：標準化後的成績分量。
     - 如果點沿對角線，成績符合高斯分佈；如果點在兩端偏離，可能是偏態分佈。

2. **檢查均勻分佈**：
   - **場景**：您生成了一組隨機數（0 到 1 之間），想確認它們是否均勻分佈。
   - **數據**：1000 個隨機數。
   - **Q-Q 圖**：
     - X 軸：均勻分佈（0,1）的分量。
     - Y 軸：隨機數的分量。
     - 如果點沿對角線，數據符合均勻分佈；如果點彎曲，可能有聚集現象。

3. **檢查指數分佈**：
   - **場景**：您記錄了顧客到達咖啡店的時間間隔（分鐘），想確認是否符合指數分佈。
   - **數據**：100 個時間間隔，平均間隔 5 分鐘。
   - **Q-Q 圖**：
     - X 軸：指數分佈（λ=1/5）的分量。
     - Y 軸：時間間隔的分量。
     - 如果點沿對角線，數據符合指數分佈；如果點偏離，可能有其他分佈特性。

---


1. **視覺化展示**：
   - 用 Python 的 `scipy.stats` 和 `matplotlib` 繪製 Q-Q 圖，展示高斯分佈的例子。例如：
     ```python
     import numpy as np
     import matplotlib.pyplot as plt
     from scipy import stats

     # 模擬高斯分佈數據
     data = np.random.normal(loc=75, scale=10, size=100)
     stats.probplot(data, dist="norm", plot=plt)
     plt.title("Q-Q Plot for Normal Distribution")
     plt.show()
     ```
   - 展示不同分佈（高斯、均勻、指數）的 Q-Q 圖，讓學生比較點的分佈。

2. **類比**：
   - 將 Q-Q 圖比喻為「試衣服」：數據是您的身材，理論分佈是衣服款式。如果衣服（分佈）合身，點會沿著對角線；如果不合身，點會偏離。

3. **互動問題**：
   - 問學生：「如果 Q-Q 圖的點在兩端向上彎曲，你覺得數據分佈可能是什麼特性？」（提示：可能有較重的尾部，如 t 分佈）。
   - 讓學生猜測某數據（例如身高、等待時間）可能符合哪種分佈，然後用 Q-Q 圖驗證。

4. **結合機器學習**：
   - 解釋 Q-Q 圖在 GaussianNB 中的重要性：檢查特徵是否符合高斯分佈假設，以確保模型的適用性。
   - 展示如果特徵不完全符合高斯分佈（例如偏態），可以用數據變換（如對數變換）來改善。

---

### 總結
- Q-Q 圖可以用來檢查數據是否符合任何理論分佈，包括：
  - 高斯分佈（常態分佈）：檢查連續數據的鐘形分佈。
  - 均勻分佈：檢查數據是否均等分佈。
  - 指數分佈：檢查等待時間等數據。
  - 對數正態分佈、伽馬分佈等其他分佈。
- 也可以比較兩個數據集的分佈是否相同。
- 如果 Q-Q 圖的點沿對角線，數據分佈與理論分佈一致；偏離則表示不符。

如果您需要更詳細的程式碼範例、數學推導，或針對特定分佈的深入解釋，請隨時告知！
